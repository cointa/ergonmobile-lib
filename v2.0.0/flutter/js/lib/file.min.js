app.file={},app.file.readLocalJSON=(e,l,t,a)=>{let o=e+l;window.resolveLocalFileSystemURL(o,e=>{e.file(e=>{let l=new FileReader;l.onloadend=e=>{try{t(JSON.parse(e.target.result))}catch(e){a(e)}},l.readAsText(e)},e=>a(e))},e=>a(e))},app.file.writeLocalJSON=(e,l,t,a,o)=>{t=JSON.stringify(t,null,"\t"),window.resolveLocalFileSystemURL(e,e=>{e.getFile(l,{create:!0},e=>{e.createWriter(e=>{e.onwriteend=()=>a(t),e.onerror=e=>o(e);let l=new Blob([t],{type:"text/plain"});e.write(l)},e=>o(e))},e=>o(e))},e=>o(e))},app.file.upload=(e,l,t,a)=>{window.resolveLocalFileSystemURL(e,a=>{a.file(a=>{if(a.size/1e3<=1024*app.config.upload.maxSize){let a=new FileUploadOptions;a.httpMethod="POST",a.chunkedMode=!0;let o={"Content-Type":"application/octet-stream","X-Filename":e.substr(e.lastIndexOf("/")+1),"X-Pathname":app.config.upload.path};a.headers=o,(new FileTransfer).upload(e,encodeURI(app.config.upload.url),e=>{if(e.response.length>0)l(e);else{t({code:"UPLOAD_EMPTY_RESPONSE",name:"Empty Response Error"})}},e=>t(e),a,!0)}else{t({code:"UPLOAD_MAX_SIZE_EXCEEDED",name:"File Too Big Error"})}},e=>t(e))},e=>t(e)),a()};